This is div.cpp original

A bit more work to make dev beta release
